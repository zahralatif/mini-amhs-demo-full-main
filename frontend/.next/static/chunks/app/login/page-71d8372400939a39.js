(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{6226:function(e,t,r){Promise.resolve().then(r.bind(r,5207))},5207:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return w}});var n=r(7437),a=r(9343),s=r(1014),o=r(537),l=r(7651),i=r(6463),u=r(4358),c=r(6727),m=r(511),d=r(3494),h=r(3983),f=r(6548),p=r(2265);let g=o.Ry({username:o.Z_().min(3,"Username must be at least 3 characters"),password:o.Z_().min(8,"Password must be at least 8 characters")});function w(){var e,t;let{login:r}=(0,l.a)(),o=(0,i.useRouter)(),[w,x]=(0,p.useState)(null),{register:v,handleSubmit:S,formState:{errors:b,isSubmitting:j}}=(0,a.cI)({resolver:(0,s.F)(g)}),y=async e=>{x(null);try{await r(e.username,e.password),o.push("/")}catch(e){x("Login failed. Please check your credentials."),console.error(e)}};return(0,n.jsx)(u.Z,{maxWidth:"xs",children:(0,n.jsxs)(c.Z,{sx:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,n.jsx)(m.Z,{component:"h1",variant:"h5",children:"Login"}),(0,n.jsxs)(c.Z,{component:"form",onSubmit:S(y),sx:{mt:1},children:[w&&(0,n.jsx)(d.Z,{severity:"error",children:w}),(0,n.jsx)(h.Z,{margin:"normal",required:!0,fullWidth:!0,id:"username",label:"Username",autoComplete:"username",autoFocus:!0,...v("username"),error:!!b.username,helperText:null===(e=b.username)||void 0===e?void 0:e.message}),(0,n.jsx)(h.Z,{margin:"normal",required:!0,fullWidth:!0,label:"Password",type:"password",id:"password",autoComplete:"current-password",...v("password"),error:!!b.password,helperText:null===(t=b.password)||void 0===t?void 0:t.message}),(0,n.jsx)(f.Z,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:j,children:j?"Logging in...":"Login"})]})]})})}},6264:function(e,t,r){},7651:function(e,t,r){"use strict";r.d(t,{H:function(){return l},a:function(){return i}});var n=r(7437),a=r(2265),s=r(6264);let o=(0,a.createContext)(void 0);function l(e){let{children:t}=e,[r,l]=(0,a.useState)(null),[i,u]=(0,a.useState)(null),[c,m]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=localStorage.getItem("jwt_token");if(e){l(e);let t=localStorage.getItem("username");t&&u(t)}m(!1)},[]);let d=async(e,t)=>{try{let{token:r}=await (0,s.postJSON)("/api/auth/login",{username:e,password:t});l(r),u(e),localStorage.setItem("jwt_token",r),localStorage.setItem("username",e)}catch(e){throw console.error("Login failed:",e),e}},h=async(e,t)=>{try{await (0,s.postJSON)("/api/auth/register",{username:e,password:t}),await d(e,t)}catch(e){throw console.error("Registration failed:",e),e}};return(0,n.jsx)(o.Provider,{value:{token:r,username:i,register:h,login:d,logout:()=>{l(null),u(null),localStorage.removeItem("jwt_token"),localStorage.removeItem("username")},isLoading:c},children:t})}function i(){let e=(0,a.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},function(e){e.O(0,[705,672,971,23,744],function(){return e(e.s=6226)}),_N_E=e.O()}]);